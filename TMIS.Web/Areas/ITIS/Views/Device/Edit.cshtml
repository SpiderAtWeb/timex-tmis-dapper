@using TMIS.Models.ITIS.VM
@model CreateDeviceVM

@section VendorStyles {
	<link rel="stylesheet" href="~/vendor/libs/flatpickr/flatpickr.css" />
	<link rel="stylesheet" href="~/vendor/libs/select2/select2.css" />
	<link href="~/css/input-text-upper.css" rel="stylesheet" />
}

@section VendorScripts {
	<script src="~/vendor/libs/flatpickr/flatpickr.js"></script>
	<script src="~/vendor/libs/select2/select2.js"></script>
}

@section PageScripts {
	<script src="~/js/form-layouts.js"></script>
	<script src="~/custom/input-text-upper.js"></script>	
}

<!-- Multi Column with Form Separator -->
<div class="card mb-6">
	<h5 class="card-header page-header">
		Update Device
	</h5>
	<form asp-action="Edit" method="post" class="card-body" id="myForm" enctype="multipart/form-data">
		<input asp-for="@Model.Device!.DeviceID" type="hidden" />
		<div class="row g-2">

			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<select asp-for="@Model.Device!.Location" asp-items="@Model.LocationList" class="select2 form-select" data-allow-clear="true">
						<option value="" Disabled Selected>- Select Location -</option>
					</select>

					<label asp-for="Device!.Location"></label>
					<span asp-validation-for="@Model.Device!.Location" class="text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<input asp-for="@Model.Device!.DeviceName" type="text" id="style-no" class="form-control" placeholder="CHO0001" />
					<label asp-for="@Model.Device!.DeviceName"></label>
					<span asp-validation-for="@Model.Device!.DeviceName" class="customerError text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<input asp-for="@Model.Device!.SerialNumber" type="text" id="style-no" class="form-control" placeholder="5CG2490NLG" />
					<label asp-for="@Model.Device!.SerialNumber"></label>
					<span asp-validation-for="@Model.Device!.SerialNumber" class="customerError text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<input asp-for="@Model.Device!.FixedAssetCode" type="text" id="style-no" class="form-control" placeholder="FAC001245" />
					<label asp-for="@Model.Device!.FixedAssetCode"></label>
					<span asp-validation-for="@Model.Device!.FixedAssetCode" class="customerError text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<input asp-for="@Model.Device!.PurchasedDate" type="date" id="datePurchased" class="form-control dob-picker" placeholder="YYYY-MM-DD" />
					<label asp-for="@Model.Device!.PurchasedDate"></label>
					<span asp-validation-for="@Model.Device!.PurchasedDate" class="text-warning"></span>
				</div>
			</div>
			<div class="col-3">
				<div class="form-floating form-floating-outline">
					<input class="form-control" type="file" name="image1">
					<label asp-for="Device.Image1Data" class="form-label"></label>
					<span asp-validation-for="Device.Image1Data" class="text-warning"></span>
				</div>
			</div>
			<div class="col-3">
				<div class="form-floating form-floating-outline">
					<input class="form-control" type="file" name="image2">
					<label asp-for="Device.Image2Data" class="form-label"></label>
				</div>
			</div>
			<div class="col-3">
				<div class="form-floating form-floating-outline">
					<input class="form-control" type="file" name="image3">
					<label asp-for="Device.Image3Data" class="form-label"></label>
				</div>
			</div>
			<div class="col-3">
				<div class="form-floating form-floating-outline">
					<input class="form-control" type="file" name="image4">
					<label asp-for="Device.Image4Data" class="form-label"></label>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<select asp-for="@Model.Device!.VendorID" asp-items="@Model.VendorsList" class="select2 form-select" data-allow-clear="true">
						<option value="" Disabled Selected>- Select Vendor -</option>
					</select>

					<label asp-for="Device!.VendorID"></label>
					<span asp-validation-for="@Model.Device!.VendorID" class="text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<select asp-for="@Model.Device!.DeviceStatusID" asp-items="@Model.DeviceStatusList" class="select2 form-select" data-allow-clear="true">
						<option value="" Disabled Selected>- Select Status -</option>
					</select>

					<label asp-for="Device!.DeviceStatusID"></label>
					<span asp-validation-for="@Model.Device!.DeviceStatusID" class="text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<input asp-for="@Model.Device!.Depreciation" type="number" id="style-no" class="form-control" placeholder="Depreciation in months" min="0" />
					<label asp-for="@Model.Device!.Depreciation"></label>
					<span asp-validation-for="@Model.Device!.Depreciation" class="customerError text-warning"></span>
				</div>
			</div>
			<div class="col-md-2">
				<div class="list-group">
					<label class="list-group-item w-100">
						<span class="form-check mb-0">
							<input asp-for="@Model.Device!.IsRented" class="form-check-input me-4" type="checkbox">
							Is Rented
						</span>
					</label>
				</div>
			</div>
			<div class="col-md-2">
				<div class="list-group">
					<label class="list-group-item w-100">
						<span class="form-check mb-0">
							<input asp-for="@Model.Device!.IsBrandNew" class="form-check-input me-4" type="checkbox">
							Is Brand New
						</span>
					</label>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<input asp-for="@Model.Device!.Remark" type="text" id="style-no" class="form-control" />
					<label asp-for="@Model.Device!.Remark"></label>
					<span asp-validation-for="@Model.Device!.Remark" class="customerError text-warning"></span>
				</div>
			</div>
			<div class="col-md-3">
				<div class="form-floating form-floating-outline">
					<select asp-for="@Model.Device!.DeviceTypeID" asp-items="@Model.DeviceTypeList" class="select2 form-select" data-allow-clear="true" disabled>
						<option value="" Disabled Selected>- Select Device Type -</option>
					</select>

					<label asp-for="Device!.DeviceTypeID"></label>
					<span asp-validation-for="@Model.Device!.DeviceTypeID" class="text-warning"></span>
				</div>
			</div>
			@if (Model.Device!.AttributeValues != null && Model.Device!.AttributeValues.Any())
			{				
				<div class="card" id="additionalField">
					<div class="card-header fw-bold">
						Additional Fields
					</div>
					<div class="card-body">
						<div class="row g-2" id="attributeContainer">
							@{
								var attributeIndex = 0;
							}
							@foreach (var item in Model.Device!.AttributeValues)
							{							
							<div class="col-md-3">
								<div class="form-floating form-floating-outline">
									<input type="text" name="Attributes[@attributeIndex].Value" class="form-control" value="@item.ValueText" />
									<input type="hidden" name="Attributes[@attributeIndex].AttributeID" value="@item.AttributeID" />
									<label>@item.Name</label>
								</div>
							</div>
							attributeIndex++;
							}
						</div>
					</div>
				</div>			
			}
			<div class="col-md-3">
				<div class="image-preview">
					@if (Model!.Device!.Image1Data != null && Model!.Device!.Image1Data.Length > 0)
					{
						var base64Image = Convert.ToBase64String(Model!.Device!.Image1Data);
						<img id="Img1" src="data:image/jpeg;base64,@base64Image" alt="Image Preview" style="max-width: 100%; height: auto;" />
					}
					else
					{
						<img src="~/img/my-images/no-image.jpg" alt="No Image Available" style="max-width: 100px; height: auto;" />
					}
				</div>
			</div>
			<div class="col-md-3">
				<div class="image-preview">
					@if (Model!.Device!.Image2Data != null && Model!.Device!.Image2Data.Length > 0)
					{
						var base64Image = Convert.ToBase64String(Model!.Device!.Image2Data);
						<img id="Img1" src="data:image/jpeg;base64,@base64Image" alt="Image Preview" style="max-width: 100%; height: auto;" />
					}
					else
					{
						<img src="~/img/my-images/no-image.jpg" alt="No Image Available" style="max-width: 100px; height: auto;" />
					}
				</div>
			</div>
			<div class="col-md-3">
				<div class="image-preview">
					@if (Model!.Device!.Image3Data != null && Model!.Device!.Image3Data.Length > 0)
					{
						var base64Image = Convert.ToBase64String(Model!.Device!.Image3Data);
						<img id="Img1" src="data:image/jpeg;base64,@base64Image" alt="Image Preview" style="max-width: 100%; height: auto;" />
					}
					else
					{
						<img src="~/img/my-images/no-image.jpg" alt="No Image Available" style="max-width: 100px; height: auto;" />
					}
				</div>
			</div>
			<div class="col-md-3">
				<div class="image-preview">
					@if (Model!.Device!.Image4Data != null && Model!.Device!.Image4Data.Length > 0)
					{
						var base64Image = Convert.ToBase64String(Model!.Device!.Image4Data);
						<img id="Img1" src="data:image/jpeg;base64,@base64Image" alt="Image Preview" style="max-width: 100%; height: auto;" />
					}
					else
					{
						<img src="~/img/my-images/no-image.jpg" alt="No Image Available" style="max-width: 100px; height: auto;" />
					}
				</div>
			</div>
			<div class="pt-1">
				<button type="submit" class="btn btn-primary me-1">Update</button>			
				<a asp-controller="Device" asp-action="Index" class="btn btn-outline-secondary">Back to List</a>
			</div>

		</div>
	</form>

</div>

